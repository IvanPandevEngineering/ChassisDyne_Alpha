# ChassisDyne
This repository is strictly for academic purposes. Do not apply changes to real-world vehicles based on ChassisDyne results. All rights reserved.

## Multibody, time-dependent vehicle simulations by Ivan Pandev
ChassisDyne is a chassis response calculator solving for tire load, lateral load distribution, and other variables not directly measurable over time, using either real-world acceleration telemetry, or synthetic acceleration and road surface data as inputs. Intuitively speaking, ChassisDyne is a virtual 7-post shaker rig with significantly increased functionality, e.g. replaying chassis acceleration inputs as well as road surface inputs.

The vehicle model consists of 6 solid bodies: Front chassis and rear chassis (connected by a torsion spring), and 4 unsprung suspension masses connected to the chassis by variations of springs, roll bars, dampers, etc. The system of differential equations describing the model's response is found in `chassis_model.py.` The transient response of this model is then solved using Runge-Kutta methods in `RK4_iterator.py,` and variables of interest are collected.

![alt text](https://github.com/IvanPandevEngineering/ChassisDyne_Alpha/blob/main/images/demo1.png)

The above screenshot generated by ChassisDyne represents a race car model, `Battle_Bimmer_28_Dec_2022`, responding to synthetic lateral and longitudinal inputs, with a bump affecting the inside tires on the right-handed turn. Demonstrated in the data is torsional chassis flex, suspension and tire harmonics, and much more. The screenshot generated by ChassisDyne below represents the same model responding to a replay of telemetry gathered during a real-world autocross race run, where chassis acceleration is known precisely, but surface conditions are assumed smooth.

![alt text](https://github.com/IvanPandevEngineering/ChassisDyne_Alpha/blob/main/images/demo2.png)

In addition to time-dependent response, ChassisDyne also offers steady-state response variables for at-a-glance evaluation of a vehicle's dynamics. The below is the return of the summary() method of the same `Battle_Bimmer_28_Dec_2022` model.
```
_______ ROLL RESPONSE _______
Roll Gradient: 1.48 deg/G
Roll Frequency: 3.168 hz
Roll Damping Ratio (Slow): 0.631
Roll Damping Ratio (Fast): 0.407
Lateral Load Distribution Front: +38.085 % Outside/G
Lateral Load Distribution Rear: +39.538 % Outside/G
Lateral Load Distribution Ratio: +0.963 % Front/G
Tip-Over G: 1.675 G


_______ PITCH RESPONSE _______
Pitch Gradient, Accel: 0.687 deg/G
Pitch Gradient, Decel: 0.515 deg/G
Pitch Frequency*: 2.915 hz
Pitch Damping Ratio* (Slow): 0.68
Pitch Damping Ratio* (Fast): 0.444
Longitudinal Load Distribution: +/-17.677 % Front/G
* - taken from contact-patch-to-IC line, see documenation.


_______ AERO PLATFORM RESPONSE _______
Pitch Angle Change: -0.02 degrees, dive
Front Ride Height Change: 2.526 mm
Rear Ride Height Change: 3.476 mm
Stability Margin: 185.856 mm, stability


_______ FRONT RIGHT CORNER _______
Wheel Rate: 65.13 N/mm
Natural Frequency: 2.627 hz
Damping Ratio, Slow Compression: 0.403 -/-
Damping Ratio, Slow Rebound: 0.644 -/-
Damping Ratio, Fast Compression: 0.222 -/-
Damping Ratio, Fast Rebound: 0.413 -/-


_______ FRONT LEFT CORNER _______
Wheel Rate: 65.13 N/mm
Natural Frequency: 2.6 hz
Damping Ratio, Slow Compression: 0.399 -/-
Damping Ratio, Slow Rebound: 0.638 -/-
Damping Ratio, Fast Compression: 0.22 -/-
Damping Ratio, Fast Rebound: 0.408 -/-


_______ REAR RIGHT CORNER _______
Wheel Rate: 51.825 N/mm
Natural Frequency: 2.673 hz
Damping Ratio, Slow Compression: 0.35 -/-
Damping Ratio, Slow Rebound: 0.678 -/-
Damping Ratio, Fast Compression: 0.2 -/-
Damping Ratio, Fast Rebound: 0.512 -/-


_______ REAR LEFT CORNER _______
Wheel Rate: 51.825 N/mm
Natural Frequency: 2.487 hz
Damping Ratio, Slow Compression: 0.326 -/-
Damping Ratio, Slow Rebound: 0.631 -/-
Damping Ratio, Fast Compression: 0.187 -/-
Damping Ratio, Fast Rebound: 0.477 -/-


_______ MASS DISTRIBUTION _______
Front Axle Mass Distribution: 52.973 %
Left Mass Distribution: 51.549 %
Cross-Wise Mass Distribution (FL/RR): 48.911 %
```

## Real-World Correlation
ChassisDyne can accept lateral and longitudinal g-force from telemetry as inputs. While some ChassisDyne outputs like instantaneous tire load are extremely difficult to measure directly and capture in telemetry, ChassisDyne also predicts measurable responses to g-force, such as roll and pitch angle. As a cursory validation of ChassisDyne outputs' correlation to real-world vehicle's behavior, its simulated roll and pitch angle outputs will be compared to the corresponding data from telemetry. This task is currently blocked since the last batch of race telemetry (see 'sample_telemetry/') shows evidence of the sensors shifting in attitude by as much as 0.7deg throughout the race course; a significant precision problem when maximum vehicle response is only 2-3deg. New sensor mounting and data collection is targeted by a racing event July 23rd, and correlation studies can resume after.

## Ongoing Development
ChassisDyne's core functionality is practically complete, but much work remains on capturing increasingly-granular details of vehicle response. This includes but is not limited to:
- High- and low- speed domain transitions of digressive dampers
- Heave springs and dampers
- Roll angle effects from engine torque

Looking far ahead, ChassisDyne can also benefit from quality-of-life/ productization improvements such as a primitive GUI, synthetic input generator, and more generalized telemetry ingestion and reformatting.
